<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æ³°è¯­å­—æ¯å­¦ä¹  - å®Œæ•´ç‰ˆå­—æ¯è¡¨</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Noto+Sans+Thai:wght@300;400;500;600;700&family=Noto+Sans+SC:wght@300;400;500;600;700&display=swap');
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Noto Sans SC', 'Noto Sans Thai', sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 50%, #f093fb 100%);
            min-height: 100vh;
            padding: 20px;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: rgba(255, 255, 255, 0.95);
            border-radius: 20px;
            padding: 30px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
        }
        
        .header {
            text-align: center;
            margin-bottom: 40px;
            background: linear-gradient(135deg, #FF6B6B, #4ECDC4);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }
        
        .header h1 {
            font-size: 2.5rem;
            margin-bottom: 10px;
        }
        
        .summary {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 15px;
            margin-bottom: 30px;
            border-left: 5px solid #4ECDC4;
        }
        
        .alphabet-section {
            margin-bottom: 40px;
        }
        
        .section-title {
            font-size: 1.8rem;
            color: #495057;
            margin-bottom: 20px;
            padding-bottom: 10px;
            border-bottom: 3px solid #4ECDC4;
        }
        
        .alphabet-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
            gap: 15px;
            margin-bottom: 30px;
        }
        
        .letter-card {
            background: white;
            border: 2px solid #e9ecef;
            border-radius: 12px;
            padding: 15px;
            text-align: center;
            transition: all 0.3s ease;
            cursor: pointer;
        }
        
        .letter-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 25px rgba(0,0,0,0.1);
            border-color: #4ECDC4;
        }
        
        .thai-letter {
            font-size: 3rem;
            font-family: 'Noto Sans Thai', sans-serif;
            color: #FF6B6B;
            margin-bottom: 10px;
        }
        
        .pronunciation {
            font-size: 1.2rem;
            color: #495057;
            margin-bottom: 5px;
            font-weight: 600;
        }
        
        .english-name {
            font-size: 0.9rem;
            color: #6c757d;
            font-style: italic;
        }
        
        .vowel-section {
            background: #fff3cd;
            padding: 20px;
            border-radius: 15px;
            margin-bottom: 30px;
        }
        
        .tone-section {
            background: #d1ecf1;
            padding: 20px;
            border-radius: 15px;
            margin-bottom: 30px;
        }
        
        .special-section {
            background: #f8d7da;
            padding: 20px;
            border-radius: 15px;
        }
        
        .audio-btn {
            background: #4ECDC4;
            color: white;
            border: none;
            border-radius: 20px;
            padding: 5px 15px;
            font-size: 0.8rem;
            cursor: pointer;
            margin-top: 5px;
        }
        
        .audio-btn:hover {
            background: #45B7D1;
        }
        
        .play-controls {
            background: linear-gradient(135deg, #FF6B6B, #4ECDC4);
            padding: 20px;
            border-radius: 15px;
            margin-bottom: 30px;
            text-align: center;
            color: white;
        }
        
        .play-btn {
            background: rgba(255,255,255,0.2);
            color: white;
            border: 2px solid white;
            border-radius: 25px;
            padding: 12px 25px;
            font-size: 1rem;
            cursor: pointer;
            margin: 0 10px;
            transition: all 0.3s ease;
            backdrop-filter: blur(10px);
        }
        
        .play-btn:hover {
            background: rgba(255,255,255,0.3);
            transform: translateY(-2px);
        }
        
        .play-btn.active {
            background: white;
            color: #FF6B6B;
        }
        
        .current-playing {
            border: 3px solid #FF6B6B !important;
            background: linear-gradient(135deg, #FF6B6B, #FF8E8E) !important;
            color: white !important;
            animation: pulse 1s infinite;
        }
        
        .current-playing .thai-letter {
            color: white !important;
        }
        
        .speed-control {
            margin-top: 15px;
        }
        
        .speed-btn {
            background: rgba(255,255,255,0.1);
            color: white;
            border: 1px solid rgba(255,255,255,0.3);
            border-radius: 15px;
            padding: 5px 15px;
            font-size: 0.9rem;
            cursor: pointer;
            margin: 0 5px;
            transition: all 0.3s ease;
        }
        
        .speed-btn:hover, .speed-btn.active {
            background: rgba(255,255,255,0.3);
        }
        
        /* å›ºå®šåœ¨é¡¶éƒ¨çš„æ§åˆ¶é¢æ¿ */
        .fixed-controls {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            padding: 10px 20px;
            z-index: 1000;
            box-shadow: 0 3px 10px rgba(0,0,0,0.2);
            display: flex;
            justify-content: center;
            align-items: center;
            flex-wrap: wrap;
            transition: all 0.3s ease;
        }
        
        .fixed-controls .control-btn {
            background: rgba(255,255,255,0.2);
            color: white;
            border: 1px solid rgba(255,255,255,0.4);
            border-radius: 20px;
            padding: 8px 16px;
            margin: 5px;
            cursor: pointer;
            font-size: 0.9rem;
            display: flex;
            align-items: center;
            transition: all 0.3s ease;
        }
        
        .fixed-controls .control-btn:hover {
            background: rgba(255,255,255,0.3);
            transform: translateY(-2px);
        }
        
        .fixed-controls .control-btn.active {
            background: white;
            color: #764ba2;
        }
        
        .control-btn .icon {
            margin-right: 5px;
            font-size: 1.2rem;
        }
        
        .control-status {
            color: white;
            margin: 0 10px;
            font-size: 0.9rem;
            background: rgba(0,0,0,0.2);
            padding: 5px 10px;
            border-radius: 10px;
            max-width: 300px;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }
        
        .toggle-controls {
            position: fixed;
            top: 10px;
            right: 10px;
            background: #764ba2;
            color: white;
            border: none;
            border-radius: 50%;
            width: 40px;
            height: 40px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.2rem;
            cursor: pointer;
            z-index: 1001;
            box-shadow: 0 2px 5px rgba(0,0,0,0.2);
            opacity: 0.7;
            transition: all 0.3s ease;
        }
        
        .toggle-controls:hover {
            opacity: 1;
            transform: rotate(180deg);
        }
        
        /* è°ƒæ•´é¡¶éƒ¨ç©ºé—´ï¼Œé˜²æ­¢æ§åˆ¶æ é®æŒ¡å†…å®¹ */
        body {
            padding-top: 70px;
            font-family: 'Noto Sans SC', 'Noto Sans Thai', sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 50%, #f093fb 100%);
            min-height: 100vh;
            padding-left: 20px;
            padding-right: 20px;
            padding-bottom: 20px;
        }
        
        @media (max-width: 768px) {
            .alphabet-grid {
                grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
            }
            
            .thai-letter {
                font-size: 2.5rem;
            }
        }
    </style>
</head>
<body>
    <!-- å›ºå®šçš„æ§åˆ¶é¢æ¿ -->
    <div class="fixed-controls" id="fixedControls">
        <button class="control-btn" id="fixedPlayAllBtn" onclick="startPlayAll()">
            <span class="icon">â–¶ï¸</span> æ’­æ”¾å…¨éƒ¨
        </button>
        <button class="control-btn" id="fixedPlayConsonantsBtn" onclick="startPlayConsonants()">
            <span class="icon">ğŸ”¤</span> æ’­æ”¾è¾…éŸ³
        </button>
        <button class="control-btn" id="fixedPlayVowelsBtn" onclick="startPlayVowels()">
            <span class="icon">ğŸµ</span> æ’­æ”¾å…ƒéŸ³
        </button>
        <button class="control-btn" id="fixedPauseBtn" onclick="pausePlay()" style="display: none;">
            <span class="icon">â¸ï¸</span> æš‚åœ
        </button>
        <button class="control-btn" id="fixedResumeBtn" onclick="resumePlay()" style="display: none;">
            <span class="icon">â¯ï¸</span> ç»§ç»­
        </button>
        <button class="control-btn" id="fixedStopBtn" onclick="stopPlay()" style="display: none;">
            <span class="icon">â¹ï¸</span> åœæ­¢
        </button>
        <div class="control-status" id="fixedStatus">æ³°è¯­å­—æ¯å­¦ä¹ </div>
    </div>
    
    <button class="toggle-controls" id="toggleControls" onclick="toggleControlPanel()">â‰¡</button>
    <div class="container">
        <div class="header">
            <h1>ğŸ‡¹ğŸ‡­ æ³°è¯­å­—æ¯å­¦ä¹ å¤§å…¨</h1>
            <p>å®Œæ•´çš„æ³°è¯­å­—æ¯è¡¨ä¸å‘éŸ³æŒ‡å—</p>
        </div>
        
        <!-- ç§»åŠ¨ç«¯éŸ³é¢‘æµ‹è¯•åŒº -->
        <div id="audioTest" style="display: none; background: #e8f4fd; padding: 15px; border-radius: 10px; margin-bottom: 20px; border: 1px solid #b8daff; text-align: center;">
            <h3 style="color: #004085; margin-bottom: 15px;">ğŸ”Š ç§»åŠ¨ç«¯éŸ³é¢‘æµ‹è¯•</h3>
            <p>è¯·ç‚¹å‡»ä¸‹é¢çš„æŒ‰é’®æµ‹è¯•æ‚¨çš„è®¾å¤‡æ˜¯å¦èƒ½æ­£å¸¸æ’­æ”¾å£°éŸ³ï¼š</p>
            <div style="margin: 15px 0;">
                <button onclick="testMobileAudio()" style="background: #007bff; color: white; border: none; padding: 10px 20px; border-radius: 5px; font-weight: bold; margin: 5px;">ç‚¹å‡»æ’­æ”¾æµ‹è¯•å£°éŸ³</button>
                <button onclick="showAudioHelp()" style="background: #6c757d; color: white; border: none; padding: 10px 20px; border-radius: 5px; margin: 5px;">æŸ¥çœ‹éŸ³é¢‘å¸®åŠ©</button>
            </div>
            <div id="audioTestResult" style="margin-top: 10px; font-weight: bold;"></div>
        </div>
        
        <!-- ç§»åŠ¨ç«¯éŸ³é¢‘å¸®åŠ© -->
        <div id="audioHelp" style="display: none; background: #d4edda; padding: 15px; border-radius: 10px; margin-bottom: 20px; border: 1px solid #c3e6cb;">
            <h3 style="color: #155724; margin-bottom: 10px;">ğŸ’¡ è§£å†³ç§»åŠ¨ç«¯å£°éŸ³é—®é¢˜</h3>
            <p>å¦‚æœæ‚¨åœ¨ç§»åŠ¨è®¾å¤‡ä¸Šå¬ä¸åˆ°å£°éŸ³ï¼Œè¯·å°è¯•ä»¥ä¸‹æ–¹æ³•ï¼š</p>
            <ol style="text-align: left; margin-left: 20px; margin-top: 10px;">
                <li><strong>ç¡®è®¤éŸ³é‡ï¼š</strong> è®¾å¤‡éŸ³é‡å·²å¼€å¯ä¸”ä¸æ˜¯é™éŸ³æ¨¡å¼</li>
                <li><strong>å¼ºåˆ¶è§£é”éŸ³é¢‘ï¼š</strong> ç‚¹å‡»â€œç‚¹å‡»æ’­æ”¾æµ‹è¯•å£°éŸ³â€æŒ‰é’®å¤šæ¬¡</li>
                <li><strong>åˆ‡æ¢æµè§ˆå™¨ï¼š</strong> å°è¯•ä½¿ç”¨Safariï¼ˆiOSï¼‰æˆ–å…¶ä»–æµè§ˆå™¨</li>
                <li><strong>æµè§ˆå™¨è®¾ç½®ï¼š</strong> ç¡®ä¿å·²æˆæƒæµè§ˆå™¨ä½¿ç”¨éŸ³é¢‘
                    <ul style="margin-left: 15px; margin-top: 5px;">
                        <li>Chrome: ç‚¹å‡»åœ°å€æ é”å›¾æ ‡ â†’ ç½‘ç«™è®¾ç½® â†’ å£°éŸ³ â†’ å…è®¸</li>
                        <li>Safari: è®¾ç½® â†’ Safari â†’ ç½‘ç«™è®¾ç½® â†’ å…è®¸æ‰€æœ‰ç½‘ç«™æ’­æ”¾å£°éŸ³</li>
                    </ul>
                </li>
                <li><strong>ä½¿ç”¨å¤–ç½®æ‰¬å£°å™¨æˆ–è€³æœºï¼š</strong> æœ‰æ—¶å€™è®¾å¤‡æŠ€æœ¯é™åˆ¶ä¼šå½±å“æ‰¬å£°å™¨æ’­æ”¾</li>
            </ol>
            <button onclick="document.getElementById('audioHelp').style.display='none';" style="background: #155724; color: white; border: none; padding: 8px 15px; border-radius: 5px; margin-top: 10px; cursor: pointer;">å…³é—­å¸®åŠ©</button>
        </div>
        
        <!-- ç§»åŠ¨ç«¯æç¤º -->
        <div id="mobileTip" style="display: none; background: #fff3cd; padding: 15px; border-radius: 10px; margin-bottom: 20px; border: 1px solid #ffeeba;">
            <h3 style="color: #856404; margin-bottom: 10px;">ğŸ“± ç§»åŠ¨ç«¯ä½¿ç”¨æç¤º</h3>
            <p>æ£€æµ‹åˆ°æ‚¨æ­£åœ¨ä½¿ç”¨ç§»åŠ¨è®¾å¤‡æµè§ˆã€‚</p>
            <p style="margin-top: 10px;"><strong>å¦‚ä½•å¬åˆ°å‘éŸ³ï¼š</strong></p>
            <ol style="margin-left: 20px; margin-top: 5px;">
                <li>è¯·å…ˆç‚¹å‡»<span style="color:red;">ä¸Šæ–¹çš„æµ‹è¯•å£°éŸ³æŒ‰é’®</span>æ¿€æ´»éŸ³é¢‘æƒé™</li>
                <li>ç„¶åç‚¹å‡»å­—æ¯å¡ç‰‡ä¸Šçš„ã€ŒğŸ”Š å‘éŸ³ã€æŒ‰é’®æµ‹è¯•</li>
                <li>å¦‚æœä»æ— å£°éŸ³ï¼Œè¯·ç‚¹å‡»ã€ŒæŸ¥çœ‹éŸ³é¢‘å¸®åŠ©ã€</li>
            </ol>
            <button onclick="forceUnlockAudio();" style="background: #856404; color: white; border: none; padding: 8px 15px; border-radius: 5px; margin-top: 10px; cursor: pointer;">è§£é”éŸ³é¢‘æƒé™</button>
            <button onclick="document.getElementById('mobileTip').style.display='none';document.getElementById('audioTest').style.display='block';" style="background: #856404; color: white; border: none; padding: 8px 15px; border-radius: 5px; margin-top: 10px; margin-left: 10px; cursor: pointer;">æˆ‘çŸ¥é“äº†</button>
        </div>
        
        <div class="summary">
            <h3>ğŸ“‹ æ³°è¯­å­—æ¯æ€»ç»“</h3>
            <p><strong>æ³°è¯­å…±æœ‰ 76 ä¸ªå­—æ¯ï¼š</strong></p>
            <ul style="margin-top: 10px; margin-left: 20px;">
                <li><strong>è¾…éŸ³å­—æ¯ï¼š44ä¸ª</strong></li>
                <li><strong>å…ƒéŸ³ç¬¦å·ï¼š32ä¸ª</strong></li>
            </ul>
            <p style="margin-top: 10px;">æ­¤å¤–è¿˜æœ‰4ä¸ªå£°è°ƒç¬¦å·å’Œ2ä¸ªç‰¹æ®Šç¬¦å·ã€‚</p>
        </div>
        
        <!-- å¾ªç¯æ’­æ”¾æ§åˆ¶ -->
        <div class="play-controls">
            <h3>ğŸµ å¾ªç¯æ’­æ”¾æ§åˆ¶</h3>
            <p>è‡ªåŠ¨æ’­æ”¾æ‰€æœ‰å­—æ¯å‘éŸ³ï¼Œå¸®åŠ©ä½ å¿«é€Ÿç†Ÿæ‚‰æ³°è¯­å­—æ¯</p>
            <div style="margin: 20px 0;">
                <button class="play-btn" id="playAllBtn" onclick="startPlayAll()">â–¶ï¸ æ’­æ”¾å…¨éƒ¨</button>
                <button class="play-btn" id="playConsonantsBtn" onclick="startPlayConsonants()">ğŸ”¤ æ’­æ”¾è¾…éŸ³</button>
                <button class="play-btn" id="playVowelsBtn" onclick="startPlayVowels()">ğŸµ æ’­æ”¾å…ƒéŸ³</button>
                <button class="play-btn" id="pauseBtn" onclick="pausePlay()" style="display: none;">â¸ï¸ æš‚åœ</button>
                <button class="play-btn" id="stopBtn" onclick="stopPlay()" style="display: none;">â¹ï¸ åœæ­¢</button>
            </div>
            <div class="speed-control">
                <span>æ’­æ”¾é€Ÿåº¦ï¼š</span>
                <button class="speed-btn" onclick="setSpeed(0.5)">0.5x</button>
                <button class="speed-btn active" onclick="setSpeed(1)">1x</button>
                <button class="speed-btn" onclick="setSpeed(1.5)">1.5x</button>
                <button class="speed-btn" onclick="setSpeed(2)">2x</button>
            </div>
            <div style="margin-top: 15px; font-size: 0.9rem;">
                <span id="playStatus">å‡†å¤‡æ’­æ”¾...</span>
            </div>
        </div>
        
        <!-- è¾…éŸ³å­—æ¯ -->
        <div class="alphabet-section">
            <h2 class="section-title">ğŸ”¤ è¾…éŸ³å­—æ¯ (44ä¸ª)</h2>
            <div class="alphabet-grid" id="consonants">
                <!-- è¾…éŸ³å­—æ¯å°†é€šè¿‡JavaScriptç”Ÿæˆ -->
            </div>
        </div>
        
        <!-- å…ƒéŸ³ç¬¦å· -->
        <div class="vowel-section">
            <h2 class="section-title">ğŸµ å…ƒéŸ³ç¬¦å· (32ä¸ª)</h2>
            <div class="alphabet-grid" id="vowels">
                <!-- å…ƒéŸ³ç¬¦å·å°†é€šè¿‡JavaScriptç”Ÿæˆ -->
            </div>
        </div>
        
        <!-- å£°è°ƒç¬¦å· -->
        <div class="tone-section">
            <h2 class="section-title">ğŸ¼ å£°è°ƒç¬¦å· (4ä¸ª)</h2>
            <div class="alphabet-grid" id="tones">
                <!-- å£°è°ƒç¬¦å·å°†é€šè¿‡JavaScriptç”Ÿæˆ -->
            </div>
        </div>
        
        <!-- ç‰¹æ®Šç¬¦å· -->
        <div class="special-section">
            <h2 class="section-title">âœ¨ ç‰¹æ®Šç¬¦å· (2ä¸ª)</h2>
            <div class="alphabet-grid" id="specials">
                <!-- ç‰¹æ®Šç¬¦å·å°†é€šè¿‡JavaScriptç”Ÿæˆ -->
            </div>
        </div>
    </div>

    <script>
        // æ³°è¯­è¾…éŸ³å­—æ¯æ•°æ®
        const consonants = [
            {thai: 'à¸', pronunciation: 'gÉ”É” gÃ i', english: 'ko kai', meaning: '(é¸¡)'},
            {thai: 'à¸‚', pronunciation: 'kÉ”É” kÃ ai', english: 'kho khai', meaning: '(è›‹)'},
            {thai: 'à¸ƒ', pronunciation: 'kÉ”É” kÃ¹at', english: 'kho khuat', meaning: '(ç“¶)'},
            {thai: 'à¸„', pronunciation: 'kÉ”É” kwaai', english: 'kho khwai', meaning: '(æ°´ç‰›)'},
            {thai: 'à¸…', pronunciation: 'kÉ”É” kon', english: 'kho khon', meaning: '(äºº)'},
            {thai: 'à¸†', pronunciation: 'kÉ”É” rÃ¡-kang', english: 'kho rakhang', meaning: '(é’Ÿ)'},
            {thai: 'à¸‡', pronunciation: 'ngÉ”É” nguu', english: 'ngo ngu', meaning: '(è›‡)'},
            {thai: 'à¸ˆ', pronunciation: 'jÉ”É” jaan', english: 'cho chan', meaning: '(ç›˜å­)'},
            {thai: 'à¸‰', pronunciation: 'chÉ”É” chÃ¬à¸‡', english: 'cho ching', meaning: '(é’¹)'},
            {thai: 'à¸Š', pronunciation: 'chÉ”É” chÃ¡ang', english: 'cho chang', meaning: '(è±¡)'},
            {thai: 'à¸‹', pronunciation: 'sÉ”É” sÃ´o', english: 'so so', meaning: '(é“¾å­)'},
            {thai: 'à¸Œ', pronunciation: 'chÉ”É” chÉ™É™', english: 'cho choe', meaning: '(æ ‘)'},
            {thai: 'à¸', pronunciation: 'yÉ”É” yÇng', english: 'yo ying', meaning: '(å¥³äºº)'},
            {thai: 'à¸', pronunciation: 'dÉ”É” chÃ -daa', english: 'do chada', meaning: '(ç‹å† )'},
            {thai: 'à¸', pronunciation: 'tÉ”É” pa-taÃ k', english: 'to patak', meaning: '(é±¼å‰)'},
            {thai: 'à¸', pronunciation: 'thÉ”É” thÄƒan', english: 'tho than', meaning: '(åº•åº§)'},
            {thai: 'à¸‘', pronunciation: 'thÉ”É” mon-thoo', english: 'tho montho', meaning: '(å¤«äºº)'},
            {thai: 'à¸’', pronunciation: 'thÉ”É” phuu-thÃ¢o', english: 'tho phuthao', meaning: '(è€äºº)'},
            {thai: 'à¸“', pronunciation: 'nÉ”É” neen', english: 'no nen', meaning: '(æ²™å¼¥)'},
            {thai: 'à¸”', pronunciation: 'dÉ”É” dÃ¨k', english: 'do dek', meaning: '(å­©å­)'},
            {thai: 'à¸•', pronunciation: 'tÉ”É” tao', english: 'to tao', meaning: '(ä¹Œé¾Ÿ)'},
            {thai: 'à¸–', pronunciation: 'thÉ”É” thÇ”ng', english: 'tho thung', meaning: '(è¢‹å­)'},
            {thai: 'à¸—', pronunciation: 'thÉ”É” tha-hÇan', english: 'tho thahan', meaning: '(å£«å…µ)'},
            {thai: 'à¸˜', pronunciation: 'thÉ”É” thong', english: 'tho thong', meaning: '(æ——å¸œ)'},
            {thai: 'à¸™', pronunciation: 'nÉ”É” nuu', english: 'no nu', meaning: '(è€é¼ )'},
            {thai: 'à¸š', pronunciation: 'bÉ”É” bai-mÃ¡ai', english: 'bo baimai', meaning: '(å¶å­)'},
            {thai: 'à¸›', pronunciation: 'pÉ”É” plaa', english: 'po pla', meaning: '(é±¼)'},
            {thai: 'à¸œ', pronunciation: 'phÉ”É” phÇ”ng', english: 'pho phueng', meaning: '(èœœèœ‚)'},
            {thai: 'à¸', pronunciation: 'fÉ”É” faa', english: 'fo fa', meaning: '(ç›–å­)'},
            {thai: 'à¸', pronunciation: 'phÉ”É” phaan', english: 'pho phan', meaning: '(æ‰˜ç›˜)'},
            {thai: 'à¸Ÿ', pronunciation: 'fÉ”É” fan', english: 'fo fan', meaning: '(ç‰™é½¿)'},
            {thai: 'à¸ ', pronunciation: 'phÉ”É” sÇm-phao', english: 'pho samphao', meaning: '(å¸†èˆ¹)'},
            {thai: 'à¸¡', pronunciation: 'mÉ”É” mÃ¡a', english: 'mo ma', meaning: '(é©¬)'},
            {thai: 'à¸¢', pronunciation: 'yÉ”É” yÃ k', english: 'yo yak', meaning: '(å¤œå‰)'},
            {thai: 'à¸£', pronunciation: 'rÉ”É” rÉ¯a', english: 'ro ruea', meaning: '(èˆ¹)'},
            {thai: 'à¸¥', pronunciation: 'lÉ”É” ling', english: 'lo ling', meaning: '(çŒ´å­)'},
            {thai: 'à¸§', pronunciation: 'wÉ”É” wÉ›É›n', english: 'wo waen', meaning: '(æˆ’æŒ‡)'},
            {thai: 'à¸¨', pronunciation: 'sÉ”É” sÇa-laa', english: 'so sala', meaning: '(å‡‰äº­)'},
            {thai: 'à¸©', pronunciation: 'sÉ”É” rÉ¯É¯-sÇi', english: 'so ruesri', meaning: '(éšå£«)'},
            {thai: 'à¸ª', pronunciation: 'sÉ”É” sÉ¯ÌŒa', english: 'so suea', meaning: '(è€è™)'},
            {thai: 'à¸«', pronunciation: 'hÉ”É” hÃ¬ip', english: 'ho hip', meaning: '(ç›’å­)'},
            {thai: 'à¸¬', pronunciation: 'lÉ”É” jÃ¹-laa', english: 'lo chula', meaning: '(é£ç­)'},
            {thai: 'à¸­', pronunciation: 'É”É” Ã ang', english: 'o ang', meaning: '(ç›†)'},
            {thai: 'à¸®', pronunciation: 'hÉ”É” nÃ³k-hÃ»uk', english: 'ho nokhuk', meaning: '(çŒ«å¤´é¹°)'}
        ];

        // æ³°è¯­å…ƒéŸ³ç¬¦å·æ•°æ®
        const vowels = [
            {thai: 'à¸°', pronunciation: 'Ã ', english: 'a (short)'},
            {thai: 'à¸²', pronunciation: 'aa', english: 'a (long)'},
            {thai: 'à¸´', pronunciation: 'Ã¬', english: 'i (short)'},
            {thai: 'à¸µ', pronunciation: 'ii', english: 'i (long)'},
            {thai: 'à¸¶', pronunciation: 'É¯Ì€', english: 'ue (short)'},
            {thai: 'à¸·', pronunciation: 'É¯É¯', english: 'ue (long)'},
            {thai: 'à¸¸', pronunciation: 'Ã¹', english: 'u (short)'},
            {thai: 'à¸¹', pronunciation: 'uu', english: 'u (long)'},
            {thai: 'à¹€', pronunciation: 'ee', english: 'e (long)'},
            {thai: 'à¹', pronunciation: 'É›É›', english: 'ae (long)'},
            {thai: 'à¹‚', pronunciation: 'oo', english: 'o (long)'},
            {thai: 'à¹ƒ', pronunciation: 'ai', english: 'ai'},
            {thai: 'à¹„', pronunciation: 'ai', english: 'ai'},
            {thai: 'à¸³', pronunciation: 'am', english: 'am'},
            {thai: 'à¹€à¸°', pronunciation: 'Ã¨', english: 'e (short)'},
            {thai: 'à¹à¸°', pronunciation: 'É›Ì€', english: 'ae (short)'},
            {thai: 'à¹‚à¸°', pronunciation: 'Ã²', english: 'o (short)'},
            {thai: 'à¹€à¸²', pronunciation: 'ao', english: 'ao'},
            {thai: 'à¸±à¸§', pronunciation: 'ua', english: 'ua'},
            {thai: 'à¸§à¸°', pronunciation: 'Ã¹a', english: 'ua (short)'},
            {thai: 'à¹€à¸­à¸°', pronunciation: 'Ã¨Ê”', english: 'oe (short)'},
            {thai: 'à¹€à¸­', pronunciation: 'É™É™', english: 'oe (long)'},
            {thai: 'à¹€à¸µà¸¢à¸°', pronunciation: 'Ã¬a', english: 'ia (short)'},
            {thai: 'à¹€à¸µà¸¢', pronunciation: 'ia', english: 'ia (long)'},
            {thai: 'à¹€à¸·à¸­à¸°', pronunciation: 'É¯Ì€a', english: 'uea (short)'},
            {thai: 'à¹€à¸·à¸­', pronunciation: 'É¯a', english: 'uea (long)'},
            {thai: 'à¸±à¸§à¸°', pronunciation: 'Ã¹a', english: 'ua (short)'},
            {thai: 'à¹€à¸´', pronunciation: 'É™É™', english: 'oe'},
            {thai: 'à¹€à¸­à¸²', pronunciation: 'ao', english: 'ao'},
            {thai: 'à¹„à¸­', pronunciation: 'ai', english: 'ai'},
            {thai: 'à¹ƒà¸­', pronunciation: 'ai', english: 'ai'},
            {thai: 'à¹€à¸­à¸¢', pronunciation: 'É™É™i', english: 'oei'}
        ];

        // å£°è°ƒç¬¦å·æ•°æ®
        const tones = [
            {thai: 'à¹ˆ', pronunciation: 'mÃ¡i Ã¨ek', english: 'mai ek (low tone)'},
            {thai: 'à¹‰', pronunciation: 'mÃ¡i thoo', english: 'mai tho (falling tone)'},
            {thai: 'à¹Š', pronunciation: 'mÃ¡i trii', english: 'mai tri (high tone)'},
            {thai: 'à¹‹', pronunciation: 'mÃ¡i jÃ t-tÃ -waa', english: 'mai chattawa (rising tone)'}
        ];

        // ç‰¹æ®Šç¬¦å·æ•°æ®
        const specials = [
            {thai: 'à¹Œ', pronunciation: 'gaa-ran', english: 'garan (silent letter)'},
            {thai: 'à¹†', pronunciation: 'mÃ¡i-yÃ¡-mÃ³k', english: 'maiyamok (repetition)'}
        ];
        
        // å¾ªç¯æ’­æ”¾ç›¸å…³å˜é‡
        let isPlaying = false;
        let isPaused = false;
        let currentPlayIndex = 0;
        let currentPlayList = [];
        let playSpeed = 1;
        let playInterval;
        let currentHighlightedCard = null;
        let isMobile = /Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent);
        let audioInitialized = false;
        let audioContext = null;
        let mobileAudioUnlocked = false;
        let audioTestDone = false;
        let audioAttempts = 0;

        // ç”Ÿæˆå­—æ¯å¡ç‰‡
        function generateLetterCard(letter) {
            return `
                <div class="letter-card" onclick="pronounce('${letter.thai}')">
                    <div class="thai-letter">${letter.thai}</div>
                    <div class="pronunciation">${letter.pronunciation}</div>
                    <div class="english-name">${letter.english}</div>
                    ${letter.meaning ? `<div class="english-name">${letter.meaning}</div>` : ''}
                    <button class="audio-btn" onclick="pronounce('${letter.thai}')">ğŸ”Š å‘éŸ³</button>
                </div>
            `;
        }

        // é¡µé¢åŠ è½½æ—¶ç”Ÿæˆæ‰€æœ‰å­—æ¯
        document.addEventListener('DOMContentLoaded', function() {
            // ç”Ÿæˆè¾…éŸ³å­—æ¯
            document.getElementById('consonants').innerHTML = 
                consonants.map(generateLetterCard).join('');
            
            // ç”Ÿæˆå…ƒéŸ³ç¬¦å·
            document.getElementById('vowels').innerHTML = 
                vowels.map(generateLetterCard).join('');
            
            // ç”Ÿæˆå£°è°ƒç¬¦å·
            document.getElementById('tones').innerHTML = 
                tones.map(generateLetterCard).join('');
            
            // ç”Ÿæˆç‰¹æ®Šç¬¦å·
            document.getElementById('specials').innerHTML = 
                specials.map(generateLetterCard).join('');
                
            // æ£€æµ‹ç§»åŠ¨è®¾å¤‡å¹¶æ˜¾ç¤ºæç¤º
            if (isMobile) {
                document.getElementById('mobileTip').style.display = 'block';
            }
            
            // åœ¨é¡µé¢åŠ è½½åå»é™¤æ»šåŠ¨äº‹ä»¶å¯¹æ§åˆ¶é¢æ¿çš„å½±å“
            document.getElementById('toggleControls').addEventListener('click', function() {
                const controlPanel = document.getElementById('fixedControls');
                controlPanel.style.display = controlPanel.style.display === 'none' ? 'flex' : 'none';
                this.textContent = controlPanel.style.display === 'none' ? 'â–¼' : 'â‰¡';
            });
            
            // åœ¨é¡µé¢ä¸Šæ·»åŠ å…¨å±€ç‚¹å‡»äº‹ä»¶å¤„ç†éŸ³é¢‘åˆå§‹åŒ–
            document.addEventListener('click', function initAudioOnClick() {
                initAudio();
                document.removeEventListener('click', initAudioOnClick);
            });
        });

        // åˆå§‹åŒ–éŸ³é¢‘ç¯å¢ƒï¼ˆè§£å†³ç§»åŠ¨ç«¯é—®é¢˜ï¼‰
        function initAudio() {
            // åªåˆå§‹åŒ–ä¸€æ¬¡
            if (audioInitialized) return;
            
            // åˆ›å»ºéŸ³é¢‘ä¸Šä¸‹æ–‡
            if (!audioContext && window.AudioContext) {
                try {
                    audioContext = new AudioContext();
                    
                    // åˆ›å»ºä¸€ä¸ªé™éŸ³çš„éŸ³é¢‘æºï¼Œç”¨äºè§£é”ç§»åŠ¨ç«¯éŸ³é¢‘
                    const silentBuffer = audioContext.createBuffer(1, 1, 22050);
                    const source = audioContext.createBufferSource();
                    source.buffer = silentBuffer;
                    source.connect(audioContext.destination);
                    source.start(0);
                } catch (e) {
                    console.log('åˆå§‹åŒ–éŸ³é¢‘ä¸Šä¸‹æ–‡å¤±è´¥:', e);
                }
            }
            
            // å¦‚æœæ”¯æŒè¯­éŸ³åˆæˆï¼Œè§£é”å®ƒ
            if ('speechSynthesis' in window) {
                try {
                    // ç›´æ¥æ’­æ”¾ä¸€ä¸ªç®€çŸ­çš„å£°éŸ³è§£é”è¯­éŸ³åˆæˆ
                    const unlock = new SpeechSynthesisUtterance('ã€ã€‘');
                    unlock.volume = 0.1;
                    unlock.rate = 0.1;
                    speechSynthesis.speak(unlock);
                    
                    // å°è¯•è¿›ä¸€æ­¥è§£é”
                    setTimeout(() => {
                        speechSynthesis.cancel(); // æ¸…ç†è¯­éŸ³é˜Ÿåˆ—
                        const unblock = new SpeechSynthesisUtterance('à¸');
                        unblock.lang = 'th-TH';
                        unblock.volume = 0.2;
                        speechSynthesis.speak(unblock);
                    }, 500);
                } catch (e) {
                    console.log('è§£é”è¯­éŸ³åˆæˆå¤±è´¥:', e);
                }
            }
            
            audioInitialized = true;
            
            // åœ¨ç§»åŠ¨ç«¯æ˜¾ç¤ºæç¤º
            if (isMobile) {
                document.getElementById('mobileTip').innerHTML += '<p style="color: green; margin-top: 10px;">éŸ³é¢‘å·²åˆå§‹åŒ–ï¼ç‚¹å‡»ä»»æ„å­—æ¯çš„å‘éŸ³æŒ‰é’®æµ‹è¯•ã€‚</p>';
            }
        }
        
        // å‘éŸ³åŠŸèƒ½
        function pronounce(letter, autoNext = false) {
            // ç¡®ä¿éŸ³é¢‘å·²åˆå§‹åŒ–
            if (!audioInitialized) {
                initAudio();
            }
            
            // ç”µè„‘è‡ªåŠ¨æ’­æ”¾æˆ–å•ä¸ªå­—æ¯ç‚¹å‡»æ’­æ”¾
            if ('speechSynthesis' in window) {
                try {
                    // åœæ­¢å½“å‰æ’­æ”¾
                    speechSynthesis.cancel();
                    
                    // å¦‚æœæ˜¯ç§»åŠ¨ç«¯è‡ªåŠ¨æ’­æ”¾æ¨¡å¼ï¼Œè·³è¿‡å‘å£°
                    if (isMobile && autoNext && isPlaying) {
                        // æ›´æ–°çŠ¶æ€ï¼Œä½†ä¸æ’­æ”¾å£°éŸ³
                        updatePlayStatus(`æ­£åœ¨å­¦ä¹ : ${letter}`);
                        if (isPlaying) {
                            setTimeout(() => {
                                playNext();
                            }, 800 / playSpeed);
                        }
                        return;
                    }
                    
                    // æ‰‹åŠ¨ç‚¹å‡»æˆ–ç”µè„‘è‡ªåŠ¨æ’­æ”¾
                    const utterance = new SpeechSynthesisUtterance(letter);
                    utterance.lang = 'th-TH';
                    utterance.rate = 0.7 * playSpeed;
                    utterance.volume = 1.0; // æœ€å¤§éŸ³é‡
                    
                    // æ’­æ”¾ç»“æŸåçš„å›è°ƒ
                    utterance.onend = function() {
                        if (autoNext && isPlaying) {
                            setTimeout(() => {
                                playNext();
                            }, 500 / playSpeed);
                        }
                    };
                    
                    // æ’­æ”¾é”™è¯¯å¤„ç†
                    utterance.onerror = function(event) {
                        console.log('è¯­éŸ³åˆæˆé”™è¯¯:', event);
                        if (autoNext && isPlaying) {
                            setTimeout(() => {
                                playNext();
                            }, 500 / playSpeed);
                        }
                    };
                    
                    // ç›´æ¥æ’­æ”¾
                    speechSynthesis.speak(utterance);
                    
                } catch (e) {
                    console.log('è¯­éŸ³åˆæˆå¼‚å¸¸:', e);
                    // é”™è¯¯ä¹Ÿè¦ç»§ç»­è‡ªåŠ¨æ’­æ”¾
                    if (autoNext && isPlaying) {
                        setTimeout(() => {
                            playNext();
                        }, 800 / playSpeed);
                    }
                }
            } else {
                // é™çº§å¤„ç†
                console.log('æµè§ˆå™¨ä¸æ”¯æŒè¯­éŸ³åˆæˆ');
                if (autoNext && isPlaying) {
                    setTimeout(() => {
                        playNext();
                    }, 800 / playSpeed);
                }
            }
        }
        
        // å¼€å§‹æ’­æ”¾æ‰€æœ‰å­—æ¯
        function startPlayAll() {
            currentPlayList = [...consonants, ...vowels, ...tones, ...specials];
            startPlay('æ’­æ”¾å…¨éƒ¨å­—æ¯');
        }
        
        // å¼€å§‹æ’­æ”¾è¾…éŸ³
        function startPlayConsonants() {
            currentPlayList = consonants;
            startPlay('æ’­æ”¾è¾…éŸ³å­—æ¯');
        }
        
        // å¼€å§‹æ’­æ”¾å…ƒéŸ³
        function startPlayVowels() {
            currentPlayList = [...vowels, ...tones, ...specials];
            startPlay('æ’­æ”¾å…ƒéŸ³ç¬¦å·');
        }
        
        // å¼€å§‹æ’­æ”¾
        function startPlay(statusText) {
            if (currentPlayList.length === 0) return;
            
            // åˆå§‹åŒ–éŸ³é¢‘
            initAudio();
            
            isPlaying = true;
            isPaused = false;
            currentPlayIndex = 0;
            
            // æ›´æ–°UI
            updatePlayButtons(true);
            updatePlayStatus(statusText);
            
            // æç¤ºç§»åŠ¨ç”¨æˆ·
            if (isMobile) {
                updatePlayStatus(statusText + ' (ç§»åŠ¨ç«¯é™éŸ³æ¨¡å¼)');
            }
            
            // å¼€å§‹æ’­æ”¾ç¬¬ä¸€ä¸ª
            playCurrentLetter();
        }
        
        // æ’­æ”¾å½“å‰å­—æ¯
        function playCurrentLetter() {
            if (!isPlaying || currentPlayIndex >= currentPlayList.length) {
                stopPlay();
                return;
            }
            
            const currentLetter = currentPlayList[currentPlayIndex];
            
            // é«˜äº®å½“å‰æ’­æ”¾çš„å­—æ¯
            highlightCurrentLetter(currentLetter.thai);
            
            // æ›´æ–°çŠ¶æ€
            updatePlayStatus(`æ­£åœ¨æ’­æ”¾: ${currentLetter.thai} (${currentPlayIndex + 1}/${currentPlayList.length})`);
            
            // æ’­æ”¾å‘éŸ³
            pronounce(currentLetter.thai, true);
        }
        
        // æ’­æ”¾ä¸‹ä¸€ä¸ª
        function playNext() {
            if (!isPlaying) return;
            
            currentPlayIndex++;
            playCurrentLetter();
        }
        
        // æš‚åœæ’­æ”¾
        function pausePlay() {
            if (!isPlaying) return;
            
            isPlaying = false;
            isPaused = true;
            speechSynthesis.cancel();
            updatePlayButtons(false, true);
            updatePlayStatus('æ’­æ”¾å·²æš‚åœ');
        }
        
        // ç»§ç»­æ’­æ”¾
        function resumePlay() {
            if (!isPaused) return;
            
            isPlaying = true;
            isPaused = false;
            updatePlayButtons(true);
            updatePlayStatus('ç»§ç»­æ’­æ”¾');
            playCurrentLetter();
        }
        
        // åœæ­¢æ’­æ”¾
        function stopPlay() {
            isPlaying = false;
            isPaused = false;
            speechSynthesis.cancel();
            currentPlayIndex = 0;
            
            // æ¸…é™¤é«˜äº®
            if (currentHighlightedCard) {
                currentHighlightedCard.classList.remove('current-playing');
                currentHighlightedCard = null;
            }
            
            updatePlayButtons(false);
            updatePlayStatus('æ’­æ”¾å·²åœæ­¢');
        }
        
        // è®¾ç½®æ’­æ”¾é€Ÿåº¦
        function setSpeed(speed) {
            playSpeed = speed;
            
            // æ›´æ–°é€Ÿåº¦æŒ‰é’®çŠ¶æ€
            document.querySelectorAll('.speed-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            event.target.classList.add('active');
            
            updatePlayStatus(`æ’­æ”¾é€Ÿåº¦è®¾ç½®ä¸º ${speed}x`);
        }
        
        // é«˜äº®å½“å‰æ’­æ”¾çš„å­—æ¯
        function highlightCurrentLetter(letter) {
            // æ¸…é™¤ä¹‹å‰çš„é«˜äº®
            if (currentHighlightedCard) {
                currentHighlightedCard.classList.remove('current-playing');
            }
            
            // æ‰¾åˆ°å½“å‰å­—æ¯çš„å¡ç‰‡å¹¶é«˜äº®
            const cards = document.querySelectorAll('.letter-card');
            cards.forEach(card => {
                const thaiLetter = card.querySelector('.thai-letter');
                if (thaiLetter && thaiLetter.textContent === letter) {
                    card.classList.add('current-playing');
                    currentHighlightedCard = card;
                    
                    // è®¡ç®—å¡ç‰‡ä½ç½®ï¼Œç•™å‡ºæ§åˆ¶æ çš„ç©ºé—´
                    const controlsHeight = document.getElementById('fixedControls').offsetHeight;
                    const cardPosition = card.getBoundingClientRect();
                    const offset = 30; // æ·»åŠ é¢å¤–ç©ºé—´
                    
                    // å¦‚æœå¡ç‰‡åœ¨å¯è§†åŒºåŸŸå†…ï¼Œä¸éœ€è¦æ»šåŠ¨
                    if (cardPosition.top < controlsHeight + offset || 
                        cardPosition.bottom > window.innerHeight - offset) {
                        // ä»…å½“å¡ç‰‡ä¸å¯è§æ—¶æ‰æ»šåŠ¨
                        window.scrollTo({
                            top: window.pageYOffset + cardPosition.top - controlsHeight - offset,
                            behavior: 'smooth'
                        });
                    }
                }
            });
        }
        
        // æ›´æ–°æ’­æ”¾æŒ‰é’®çŠ¶æ€
        function updatePlayButtons(playing, paused = false) {
            const playBtns = ['playAllBtn', 'playConsonantsBtn', 'playVowelsBtn', 'fixedPlayAllBtn', 'fixedPlayConsonantsBtn', 'fixedPlayVowelsBtn'];
            const pauseBtns = ['pauseBtn', 'fixedPauseBtn'];
            const resumeBtns = ['fixedResumeBtn'];
            const stopBtns = ['stopBtn', 'fixedStopBtn'];
            
            // æ’­æ”¾æŒ‰é’®
            playBtns.forEach(id => {
                const btn = document.getElementById(id);
                if (btn) {
                    btn.style.display = playing ? 'none' : 'inline-block';
                    btn.classList.remove('active');
                }
            });
            
            // æš‚åœæŒ‰é’®
            pauseBtns.forEach(id => {
                const btn = document.getElementById(id);
                if (btn) {
                    btn.style.display = (playing && !paused) ? 'inline-block' : 'none';
                }
            });
            
            // ç»§ç»­æŒ‰é’®
            resumeBtns.forEach(id => {
                const btn = document.getElementById(id);
                if (btn) {
                    btn.style.display = paused ? 'inline-block' : 'none';
                }
            });
            
            // åœæ­¢æŒ‰é’®
            stopBtns.forEach(id => {
                const btn = document.getElementById(id);
                if (btn) {
                    btn.style.display = (playing || paused) ? 'inline-block' : 'none';
                }
            });
        }
        
        // æ›´æ–°æ’­æ”¾çŠ¶æ€æ–‡æœ¬
        function updatePlayStatus(text) {
            const statusElement = document.getElementById('playStatus');
            if (statusElement) {
                statusElement.textContent = text;
            }
            
            // åŒæ—¶æ›´æ–°å›ºå®šæ§åˆ¶æ çŠ¶æ€
            const fixedStatusElement = document.getElementById('fixedStatus');
            if (fixedStatusElement) {
                fixedStatusElement.textContent = text;
            }
        }
        
        // æ˜¾ç¤º/éšè—æ§åˆ¶é¢æ¿
        function toggleControlPanel() {
            const controlPanel = document.getElementById('fixedControls');
            if (controlPanel.style.display === 'none') {
                controlPanel.style.display = 'flex';
            } else {
                controlPanel.style.display = 'none';
            }
            
            const toggleBtn = document.getElementById('toggleControls');
            toggleBtn.textContent = controlPanel.style.display === 'none' ? 'â–¼' : 'â‰¡';
        }

        // æ·»åŠ æœç´¢åŠŸèƒ½
        function searchLetter() {
            const searchTerm = document.getElementById('search').value.toLowerCase();
            const cards = document.querySelectorAll('.letter-card');
            
            cards.forEach(card => {
                const text = card.textContent.toLowerCase();
                if (text.includes(searchTerm)) {
                    card.style.display = 'block';
                } else {
                    card.style.display = 'none';
                }
            });
        }
        
        // å¼ºåˆ¶è§£é”ç§»åŠ¨ç«¯éŸ³é¢‘
        function forceUnlockAudio() {
            audioAttempts++;
            
            // ä»å¤´å¼€å§‹åˆå§‹åŒ–éŸ³é¢‘
            audioInitialized = false;
            initAudio();
            
            // å°è¯•æ’­æ”¾ä¸€æ®µç®€çŸ­å£°éŸ³
            playTestSound();
            
            // æ›´æ–°æŒ‰é’®æ–‡æœ¬
            const unlockBtn = document.querySelector('button[onclick="forceUnlockAudio();"]');
            if (unlockBtn) {
                unlockBtn.textContent = `è§£é”éŸ³é¢‘æƒé™ (å·²å°è¯•${audioAttempts}æ¬¡)`;
            }
            
            // æ˜¾ç¤ºæµ‹è¯•åŒºåŸŸ
            document.getElementById('audioTest').style.display = 'block';
        }

        // æµ‹è¯•ç§»åŠ¨ç«¯éŸ³é¢‘
        function testMobileAudio() {
            if (!audioInitialized) {
                initAudio();
            }
            
            // æ›´æ–°æµ‹è¯•æ¬¡æ•°
            audioAttempts++;
            
            // æ’­æ”¾æµ‹è¯•å£°éŸ³
            playTestSound();
            
            // æ›´æ–°æµ‹è¯•åŒºåŸŸ
            const resultDiv = document.getElementById('audioTestResult');
            resultDiv.innerHTML = `æ­£åœ¨æµ‹è¯•... å·²å°è¯•${audioAttempts}æ¬¡<br>å¦‚æœå¬åˆ°å£°éŸ³ï¼Œè¯·ç‚¹å‡»ä¸‹é¢çš„æŒ‰é’®ï¼š`;
            resultDiv.innerHTML += `<br><button onclick="audioTestSuccess()" style="background: #28a745; color: white; border: none; padding: 8px 15px; border-radius: 5px; margin: 5px; cursor: pointer;">âœ… æˆ‘å¬åˆ°å£°éŸ³äº†</button>`;
            resultDiv.innerHTML += `<button onclick="audioTestFailed()" style="background: #dc3545; color: white; border: none; padding: 8px 15px; border-radius: 5px; margin: 5px; cursor: pointer;">âŒ æ²¡å¬åˆ°å£°éŸ³</button>`;
        }

        // æ’­æ”¾æµ‹è¯•å£°éŸ³
        function playTestSound() {
            // ä½¿ç”¨å¤šç§æ–¹æ³•å°è¯•æ’­æ”¾å£°éŸ³
            
            // 1. å°è¯•ä½¿ç”¨æ ‡å‡†HTML5 Audio
            try {
                const audio = new Audio();
                audio.src = 'data:audio/mp3;base64,/+MYxAAAAANIAAAAAExBTUUzLjk4LjIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA';
                audio.volume = 1.0;
                audio.play().then(() => {
                    console.log('æ ‡å‡†éŸ³é¢‘æ’­æ”¾æˆåŠŸ');
                    mobileAudioUnlocked = true;
                }).catch(e => {
                    console.log('æ ‡å‡†éŸ³é¢‘æ’­æ”¾å¤±è´¥:', e);
                });
            } catch (e) {
                console.log('æ ‡å‡†éŸ³é¢‘æ’­æ”¾å¼‚å¸¸:', e);
            }
            
            // 2. å°è¯•ä½¿ç”¨è¯­éŸ³åˆæˆAPI
            if ('speechSynthesis' in window) {
                try {
                    // åœæ­¢å½“å‰æ’­æ”¾
                    speechSynthesis.cancel();
                    
                    // å…ˆå°è¯•è‹±æ–‡å‘éŸ³ï¼ˆæ›´å®¹æ˜“å·¥ä½œï¼‰
                    const utterance1 = new SpeechSynthesisUtterance('Test sound');
                    utterance1.volume = 1.0;
                    utterance1.rate = 1.0;
                    utterance1.pitch = 1.0;
                    speechSynthesis.speak(utterance1);
                    
                    // å†å°è¯•æ³°è¯­å‘éŸ³
                    setTimeout(() => {
                        const utterance2 = new SpeechSynthesisUtterance('à¸ à¸‚ à¸„');
                        utterance2.lang = 'th-TH';
                        utterance2.volume = 1.0;
                        utterance2.rate = 0.8;
                        speechSynthesis.speak(utterance2);
                    }, 1000);
                } catch (e) {
                    console.log('è¯­éŸ³åˆæˆå¼‚å¸¸:', e);
                }
            }
            
            // 3. å°è¯•ä½¿ç”¨Web Audio API
            if (audioContext) {
                try {
                    // åˆ›å»ºä¸€ä¸ªéœ‡è¡å™¨
                    const oscillator = audioContext.createOscillator();
                    oscillator.type = 'sine';
                    oscillator.frequency.setValueAtTime(440, audioContext.currentTime); // A4 éŸ³é«˜
                    
                    // åˆ›å»ºéŸ³é‡èŠ‚ç‚¹
                    const gainNode = audioContext.createGain();
                    gainNode.gain.setValueAtTime(0.2, audioContext.currentTime);
                    
                    // è¿æ¥èŠ‚ç‚¹
                    oscillator.connect(gainNode);
                    gainNode.connect(audioContext.destination);
                    
                    // æ’­æ”¾ä¸€å°æ®µæ—¶é—´
                    oscillator.start();
                    oscillator.stop(audioContext.currentTime + 0.5);
                } catch (e) {
                    console.log('Web Audio APIå¼‚å¸¸:', e);
                }
            }
        }

        // éŸ³é¢‘æµ‹è¯•æˆåŠŸ
        function audioTestSuccess() {
            mobileAudioUnlocked = true;
            audioTestDone = true;
            document.getElementById('audioTestResult').innerHTML = 
                `<div style="color: green; font-weight: bold;">æ­å–œï¼æ‚¨çš„è®¾å¤‡å¯ä»¥æ­£å¸¸æ’­æ”¾å£°éŸ³ã€‚<br>ç°åœ¨ä½ å¯ä»¥å°è¯•ç‚¹å‡»å­—æ¯å¡ç‰‡ä¸Šçš„ã€Œå‘éŸ³ã€æŒ‰é’®äº†ã€‚</div>`;
        }

        // éŸ³é¢‘æµ‹è¯•å¤±è´¥
        function audioTestFailed() {
            document.getElementById('audioTestResult').innerHTML = 
                `<div style="color: red; font-weight: bold;">æŠ±æ­‰ï¼Œæ‚¨çš„è®¾å¤‡å¯èƒ½ä¸æ”¯æŒæ­¤ç½‘ç«™çš„éŸ³é¢‘æ’­æ”¾ã€‚<br>è¯·å°è¯•ã€ŒæŸ¥çœ‹éŸ³é¢‘å¸®åŠ©ã€ä¸­çš„è§£å†³æ–¹æ³•ã€‚</div>`;
            showAudioHelp();
        }

        // æ˜¾ç¤ºéŸ³é¢‘å¸®åŠ©
        function showAudioHelp() {
            document.getElementById('audioHelp').style.display = 'block';
        }
    </script>
</body>
</html>


